(()=>{var e={503:function(e){e.exports=function(){class e{constructor(e){this.init=this.init.bind(this),this.create=this.create.bind(this),this.assets_dir=e}init(){var t;return this.game.plugins.add(Phaser.Plugin.SaveCPU).renderOnFPS=60,this.gameWidth=this.game.width,(t=document.getElementById("game").style).position="relative",t.cursor="default",this.menuFontColor="#FFFFFF",this.menuFont={font:"18pt "+e.MAIN_FONT,fill:this.menuFontColor,align:"center"},this.isWinner=!1,this.winAnimationComplete=!1,this.gameUnderway=!1}create(){var t,i;if(t=e.MENUBAR_HEIGHT,this.backgroundGroup=this.game.add.group(),this.background=this.game.add.image(0,t,"background"),this.backgroundGroup.add(this.background),this.marker=this.game.add.graphics(0,0),this.playingArea=new Phaser.Rectangle(0,t,Math.floor(this.PLAY_AREA_RATIO*this.game.width),this.game.height-t),this.background.scale.set(this.getBackgroundScale(this.background)),null!=this.revealer&&this.initRevealer(),this.drawMenubar(),null!=(i=this.revealer)&&i.create("textures"),this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.fullScreenTarget=document.getElementById("game"),this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.game.scale.refresh(),null!=this.revealer)return document.getElementById("gallery-links-toggle").addEventListener("click",(function(){return document.getElementById("unlocked_list").classList.toggle("minimized")}))}drawMenubar(){var t,i,s,n,r,a,h,l,o,u;for(t=e.MENUBAR_HEIGHT,i=e.MENU_SPACING,(s=this.game.add.bitmapData(this.game.world.width,t)).addToWorld(),r=a=0,l=t;0<=l?a<l:a>l;r=0<=l?++a:--a)n=Phaser.Color.interpolateColor(4473924,0,t,r),s.rect(0,r,this.game.world.width,r+1,Phaser.Color.getWebRGB(n));return u=(h=t/2)+3,this.menubarMidY=u,this.titleText=this.game.add.text(this.game.world.centerX,u,this.TEXT.title,this.menuFont),this.titleText.anchor.set(.5),this.newGameButton=this.game.add.text(i,u,"New Game",this.menuFont),this.newGameButton.anchor.set(0,.5),this.newGameButton.inputEnabled=!0,this.newGameButton.input.useHandCursor=!0,this.newGameButton.events.onInputDown.add(this.newGame,this),o=this.game.width-i,this.fullScreenButton=this.game.add.image(o,h,this.createFullscreenIcon()),this.fullScreenButton.anchor.set(1,.5),this.fullScreenButton.inputEnabled=!0,this.fullScreenButton.input.useHandCursor=!0,this.fullScreenButton.events.onInputDown.add(this.fullScreen,this),this.game.scale.onFullScreenError.add(this.fullScreenFailure,this)}createFullscreenIcon(){var e,t,i;return(t=this.game.add.graphics(0,0)).lineStyle(3,16777215,1),7,e=20,t.lineTo(7,0),t.moveTo(13,0),t.lineTo(e,0),t.lineTo(e,7),t.moveTo(e,13),t.lineTo(e,e),t.lineTo(13,e),t.moveTo(7,e),t.lineTo(0,e),t.lineTo(0,13),t.moveTo(0,7),t.lineTo(0,0),i=t.generateTexture(),t.destroy(),i}getBackgroundScale(e){var t,i,s,n;return s=e.width,t=e.height,n=i=1,s<this.game.width&&(n=this.game.width/e.width),t<this.game.height&&(i=this.game.height/e.height),Math.max(n,i,1)}getGameDimensions(){var e,t,i,s;return s=document.body.clientWidth,(i=document.body.clientHeight)/s>=this.HEIGHT_WIDTH_RATIO?(t=s,e=Math.round(this.HEIGHT_WIDTH_RATIO*t)):(e=i,t=Math.round(1/this.HEIGHT_WIDTH_RATIO*e)),[t,e]}start(){var e,t,i;return[i,e]=this.getGameDimensions(),t={init:this.init,preload:this.preload,create:this.create,update:this.update},this.game=new Phaser.Game(i,e,Phaser.CANVAS,"game",t)}initRevealer(){var e;return(e=this.playingArea.clone()).x=this.playingArea.width+1,e.width=this.game.width-this.playingArea.width,this.revealer.setBounds(e)}fullScreenFailure(){return alert("Full screen mode didn't work. The device may not support it.")}fullScreen(){return this.game.scale.isFullScreen?this.game.scale.stopFullScreen():this.game.scale.startFullScreen()}newGame(){var e,t;if(this.gameUnderway=!1,this.winAnimationComplete=!1,null!=(e=this.revealer)&&e.resetCovers(),this.isWinner)return this.isWinner=!1,null!=(t=this.revealer)?t.readyImage():void 0}newRevealerImage(){0}toggleAllInputs(e){this.newGameButton.input.enabled=e,this.fullScreenButton.input.enabled=e}}return e.MENUBAR_HEIGHT=40,e.MENU_SPACING=10,e.MAIN_FONT="Sarabun",e}.call(this)},785:function(e,t,i){var s,n,r=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};s=i(503),n=i(591),e.exports=function(){var e,t,i,a,h,l,o,u;class d extends s{constructor(){super(...arguments),this.preload=this.preload.bind(this),this.create=this.create.bind(this),this.setNumFlags=this.setNumFlags.bind(this),this.createMatrix=this.createMatrix.bind(this),this.newGame=this.newGame.bind(this),this.loseGame=this.loseGame.bind(this),this.tileClick=this.tileClick.bind(this),this.doWin=this.doWin.bind(this),this.animateWin=this.animateWin.bind(this),this.uncoverEmptyTiles=this.uncoverEmptyTiles.bind(this),this.uncoverTile=this.uncoverTile.bind(this),this.drawLoseScreen=this.drawLoseScreen.bind(this)}preload(){return r(this,d),this.game.load.atlas("textures",`${this.assets_dir}/sprites.png`,`${this.assets_dir}/sprites.json`),this.game.load.image("background",`${this.assets_dir}/background.jpg`)}create(){var e,i,s,o,u,c,m,g,f;for(r(this,d),this.tileSize=this.game.world.width*this.PLAY_AREA_RATIO*t/h,this.imgScale=this.tileSize/this.game.cache.getFrameData("textures").getFrameByName("tile1").width,super.create(),this.fieldRect=new Phaser.Rectangle(0,0,this.tileSize*h,this.tileSize*l),this.fieldRect.centerOn(this.game.world.centerX*this.PLAY_AREA_RATIO,this.game.world.centerY+a/2),document.oncontextmenu=e=>!this.fieldRect.contains(e.offsetX,e.offsetY),(o=this.game.add.graphics(this.fieldRect.x-2,this.fieldRect.y-2)).lineStyle(1,8421504),o.drawRect(0,0,this.fieldRect.width+3,this.fieldRect.height+3),this.tiles=[],m=u=0,g=l;0<=g?u<g:u>g;m=0<=g?++u:--u)for(this.tiles.push([]),i=c=0,f=h;0<=f?c<f:c>f;i=0<=f?++c:--c)(e=this.game.add.button(this.fieldRect.left+i*this.tileSize,this.fieldRect.top+m*this.tileSize,"textures",this.tileClick)).scale.set(this.imgScale),this.tiles[m].push(new n(m,i,e));return s=(this.fieldRect.bottom+this.game.world.height)/2,this.mineCounter1=this.game.add.image(this.fieldRect.centerX-2,s,"textures"),this.mineCounter1.anchor.setTo(1,.5),this.mineCounter1.scale.set(this.imgScale),this.mineCounter2=this.game.add.image(this.fieldRect.centerX+2,s,"textures"),this.mineCounter2.anchor.setTo(0,.5),this.mineCounter2.scale.set(this.imgScale),this.smiley=this.game.add.button(this.fieldRect.centerX,(a+this.fieldRect.top)/2,"textures",this.newGame),this.smiley.anchor.setTo(.5),this.smiley.scale.set(this.imgScale),this.newGame(),this.setupDone=!0}setNumFlags(e){var t,i,s;if(r(this,d),this.numFlags=e,(t=o-this.numFlags)<0&&(t=0),s=`digits${Math.floor(t/10)}`,this.mineCounter1.frameName!==s&&(this.mineCounter1.frameName=s),i="digits"+t%10,this.mineCounter2.frameName!==i)return this.mineCounter2.frameName=i}createMatrix(){var e,t,i,s,n,a,u,c,m,g,f,p,v;for(r(this,d),this.mineTiles=[],p=[],n=0,g=o;0<=g?n<g:n>g;0<=g?n++:n--)f=!0,p.push(function(){var n;for(n=[];f;)a=Math.floor(Math.random()*l),e=Math.floor(Math.random()*h),this.tiles[a][e].hasMine?n.push(void 0):(f=!1,this.tiles[a][e].hasMine=!0,this.mineTiles.push(this.tiles[a][e]),m=a-1<0?a:a-1,c=a+2>l?l:a+2,s=e-1<0?e:e-1,i=e+2>h?h:e+2,n.push(function(){var e,n,r,a;for(a=[],u=e=n=m,r=c;n<=r?e<r:e>r;u=n<=r?++e:--e)a.push(function(){var e,n,r,a;for(a=[],t=e=n=s,r=i;n<=r?e<r:e>r;t=n<=r?++e:--e)(v=this.tiles[u][t]).hasMine?a.push(void 0):a.push(v.mineCount+=1);return a}.call(this));return a}.call(this)));return n}.call(this));return p}newGame(){var e,t,i,s,n,a,h,l;if(r(this,d),null!=this.setupDone)for(null!=(n=this.loseScreen)&&(n.visible=!1),e=0,i=(a=this.tiles).length;e<i;e++)for(t=0,s=(l=a[e]).length;t<s;t++)l[t].init();return this.nonMinesLeft=u,this.setNumFlags(0),this.createMatrix(),this.smiley.frameName="smiley_ok",null!=(h=this.winMessageGroup)&&(h.visible=!1),super.newGame()}loseGame(e){var t,i,s,a,h,l,o,u,c,m,g;for(r(this,d),e.setFrame("explosion"),i=0,h=(c=this.mineTiles).length;i<h;i++)(u=c[i])!==e&&u.state!==n.FLAGGED&&u.setFrame("bad_tile");for(s=0,l=(m=this.tiles).length;s<l;s++)for(a=0,o=(g=m[s]).length;a<o;a++)(t=g[a]).state!==n.FLAGGED||t.hasMine||t.setFrame("misflagged");return this.smiley.frameName="smiley_lose",this.drawLoseScreen(),this.disableAllTiles()}disableAllTiles(){var e,t,i,s,n,r;for(s=[],e=0,t=(i=this.tiles).length;e<t;e++)n=i[e],s.push(function(){var e,t,i;for(i=[],e=0,t=n.length;e<t;e++)r=n[e],i.push(r.button.input.enabled=!1);return i}());return s}tileClick(e,t,i){var s;if(r(this,d),this.gameUnderway=!0,s=e.tile,t.leftButton.justReleased()){if(s.state!==n.FLAGGED){if(s.hasMine)return this.loseGame(s);if(this.uncoverTile(s),0===s.mineCount&&this.uncoverEmptyTiles(s),0===this.nonMinesLeft)return this.doWin()}}else if(t.rightButton.justReleased()&&(s.state===n.FLAGGED&&this.setNumFlags(this.numFlags-1),s.setState((s.state+1)%3),s.state===n.FLAGGED))return this.setNumFlags(this.numFlags+1)}doWin(){var e,t,i,s;for(r(this,d),this.isWinner=!0,this.smiley.frameName="smiley_win",this.disableAllTiles(),this.setNumFlags(o),e=0,t=(i=this.mineTiles).length;e<t;e++)(s=i[e]).state!==n.FLAGGED&&s.setState(n.FLAGGED);return this.animateWin()}animateWin(){var t,s,n,a,h,l,u,c,m,g,f,p,v;for(r(this,d),this.toggleAllInputs(!1),this.tileSize,p=this,f=function(){var t,s,n,r;return null!=this.winMessageGroup?this.winMessageGroup.visible=!0:(this.winMessageGroup=this.game.add.group(),7,r=this.fieldRect.width-14,150,75,(t=this.game.add.graphics(this.fieldRect.x+7,this.fieldRect.centerY-75,this.winMessageGroup)).beginFill(0,.85),t.drawRoundedRect(0,0,r,150,30),t.endFill(),s={font:"50pt "+e,fill:"#73BAD7",boundsAlignH:"center",boundsAlignV:"bottom"},this.game.add.text(0,0,"Mines cleared!",s,this.winMessageGroup).setTextBounds(t.left,t.top,r,Math.round(100)),n={font:"20pt "+i,fill:"#FF0",boundsAlignH:"center",boundsAlignV:"middle"},this.game.add.text(0,0,"Click 'New Game' to play again",n,this.winMessageGroup).setTextBounds(t.left,this.fieldRect.centerY,r,75)),this.toggleAllInputs(!0)},n=0,m=function(){if(this,this.remove(),(n+=1)===o)return p.game.time.events.add(300,f,p)},t=function(){return this,this.setFrame("explosion"),p.game.time.events.add(70,m,this)},a=0,s=function(){var e,i,s,n,r,h;if(this,this.setFrame("blue_flag"),(a+=1)===o){for(e=1,r=[],i=0,s=(n=p.mineTiles).length;i<s;i++)h=n[i],p.game.time.events.add(120*e,t,h),r.push(e+=1);return r}},h=1,g=[],l=0,u=(c=this.mineTiles).length;l<u;l++)v=c[l],this.game.time.events.add(80*h,s,v),g.push(h+=1);return g}uncoverEmptyTiles(e){var t,i,s,a,o,u,c,m,g,f,p,v,w,b,y,S,P;for(r(this,d),e.remove(),v=e.row-1<0?e.row:e.row-1,p=e.row+2>l?l:e.row+2,a=e.col-1<0?e.col:e.col-1,s=e.col+2>h?h:e.col+2,g=[],f=o=w=v,b=p;w<=b?o<b:o>b;f=w<=b?++o:--o)for(i=u=y=a,S=s;y<=S?u<S:u>S;i=y<=S?++u:--u)(t=this.tiles[f][i])!==e&&(t.state!==n.BLANK&&t.state!==n.QUESTION||(this.uncoverTile(t),0===t.mineCount&&g.push(t)));for(P=[],c=0,m=g.length;c<m;c++)e=g[c],P.push(this.uncoverEmptyTiles(e));return P}uncoverTile(e){var t;return r(this,d),e.setState(n.UNCOVERED),this.nonMinesLeft-=1,null!=(t=this.revealer)?t.reveal(this.nonMinesLeft):void 0}drawLoseScreen(){var e,t,s,n,a,h;return r(this,d),null!=this.loseScreen?this.loseScreen.visible=!0:(this.loseScreen=this.game.add.group(),s=this.smiley.top+Math.round(this.smiley.height/2),(e=this.game.add.image(this.smiley.left-20,s,"textures","gameover1")).anchor.setTo(1,.5),(t=this.game.add.image(this.smiley.right+20,s,"textures","gameover2")).anchor.y=.5,e.scale.set(this.imgScale),t.scale.set(this.imgScale),n={font:"22pt "+i,fill:"#ff0",boundsAlignH:"center",boundsAlignV:"middle"},(a=this.game.add.text(0,0,"Click 'New Game' to try again",n)).setTextBounds(this.fieldRect.x,this.fieldRect.bottom+3,this.fieldRect.width,this.mineCounter1.top-this.fieldRect.bottom),n.font="18pt "+i,n.fill="#A9DDFF",(h=this.game.add.text(0,0,"Valiant effort, but you blew up",n)).setTextBounds(this.fieldRect.x,this.mineCounter1.bottom,this.fieldRect.width,this.game.world.height-this.mineCounter1.bottom),this.loseScreen.addMultiple([e,t,a,h]))}}return a=s.MENUBAR_HEIGHT,i=s.MAIN_FONT,e="Piedra",d.prototype.TEXT={title:"Minesweeper"},d.prototype.HEIGHT_WIDTH_RATIO=1.5,d.prototype.PLAY_AREA_RATIO=1,u=(h=12)*(l=12)-(o=30),t=.9,d}.call(this)},591:function(e){e.exports=function(){class e{constructor(e,t,i){this.init=this.init.bind(this),this.setState=this.setState.bind(this),this.setFrame=this.setFrame.bind(this),this.remove=this.remove.bind(this),this.row=e,this.col=t,this.button=i,this.button.tile=this,this.overlay=this.button.game.add.image(0,0,"textures"),this.button.addChild(this.overlay),this.button.inputEnabled=!0,this.init()}init(){return this.mineCount=0,this.state=e.BLANK,this.hasMine=!1,this.overlay.kill(),"tile1"!==this.button.frameName&&"tile2"!==this.button.frameName&&(this.button.frameName=(this.col+this.row)%2%2==0?"tile1":"tile2"),this.button.visible||this.button.revive(),this.button.input.enabled=!0}setState(t){var i;return this.state=t,t===e.UNCOVERED?0===this.mineCount?this.remove():(this.overlay.kill(),this.setFrame(`${this.mineCount}`),this.button.input.enabled=!1):(i=function(){switch(this.state){case e.BLANK:return"tile";case e.FLAGGED:return"red_flag";case e.QUESTION:return"question"}}.call(this),this.setFrame(i))}setFrame(e){return"tile"===e?this.overlay.kill():"question"!==e&&"red_flag"!==e&&"blue_flag"!==e&&"misflagged"!==e?("explosion"!==e&&"bad_tile"!==e||this.overlay.kill(),this.button.frameName=e):(this.overlay.frameName=e,this.overlay.visible?void 0:this.overlay.revive())}remove(){return this.overlay.kill(),this.button.kill(),this.button.input.enabled=!1}}return e.BLANK=0,e.FLAGGED=1,e.QUESTION=2,e.UNCOVERED=3,e}.call(this)},419:()=>{Phaser.Plugin.SaveCPU=function(e,t){"use strict";Phaser.Plugin.call(this,e,t)},Phaser.Plugin.SaveCPU.prototype=Object.create(Phaser.Plugin.prototype),Phaser.Plugin.SaveCPU.constructor=Phaser.Plugin.SaveCPU,Phaser.Plugin.SaveCPU.prototype.init=function(){"use strict";var e;this.__defineSetter__("renderOnFPS",(function(e){this._renderOnFPS=e,this._tsdiff=1e3/e})),this.__defineGetter__("renderOnFPS",(function(){return this._renderOnFPS})),this._tsdiff=0,this.renderOnFPS=30,this.renderOnPointerChange=!1,this.renderDirty=!0,this.game.updateRender?this._init1():this._init0(),this.fpsDirty=0,this.hrts=0,e=this,window.requestAnimationFrame((function(t){e._trackFPS(t)}))},Phaser.Plugin.SaveCPU.prototype._init0=function(){this.renderType=this.game.renderType,this.switchRender=this._switchRender0},Phaser.Plugin.SaveCPU.prototype._init1=function(){var e=this.game;e.updateRenderReal=e.updateRender,e.updateRenderNull=function(){},this.switchRender=this._switchRender1},Phaser.Plugin.SaveCPU.prototype._trackFPS=function(e){var t;e-this.hrts>this._tsdiff&&(this.fpsDirty=!0,this.hrts=e),t=this,window.requestAnimationFrame((function(e){t._trackFPS(e)}))},Phaser.Plugin.SaveCPU.prototype._switchRender0=function(){"use strict";var e=this.game;this.renderDirty?e.renderType=this.renderType:e.renderType=Phaser.HEADLESS,this.renderDirty=!1},Phaser.Plugin.SaveCPU.prototype._switchRender1=function(){"use strict";var e=this.game;this.renderDirty?e.updateRender=e.updateRenderReal:e.updateRender=e.updateRenderNull},Phaser.Plugin.SaveCPU.prototype.forceRender=function(){"use strict";this.renderDirty=!0},Phaser.Plugin.SaveCPU.prototype._forceRenderOnPointerChange=function(){"use strict";if(!this.renderOnPointerChange)return!1;var e=this.game.input;e.oldx===e.x&&e.oldy===e.y||(this.forceRender(),e.oldx=e.x,e.oldy=e.y),e.oldDown!==e.activePointer.isDown&&(this.forceRender(),e.oldDown=e.activePointer.isDown)},Phaser.Plugin.SaveCPU.prototype._forceRenderOnFPS=function(){"use strict";return!(!this.renderOnFPS||!this.fpsDirty)&&(this.fpsDirty=!1,this.forceRender(),!0)},Phaser.Plugin.SaveCPU.prototype.postUpdate=function(){"use strict";(this.renderDirty||this._forceRenderOnFPS()||this._forceRenderOnPointerChange())&&this.switchRender()},Phaser.Plugin.SaveCPU.prototype.postRender=function(){"use strict";this.renderDirty&&(this.renderDirty=!1,this.switchRender())}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,i),r.exports}(()=>{i(419);const e=i(785);document.addEventListener("DOMContentLoaded",(()=>new e("/static/game_assets/minesweeper").start()))})()})();