(()=>{var t={30:function(t){t.exports=function(){class t{isDiffColorThan(t){return 1==(+(this.suit-t.suit)%(e=+(e=2))+e)%e;var e}isOneLowerThan(t){return this.rank===t.rank-1}setLocation(t,e){return this.selectArea.x=this.image.x=t,this.selectArea.y=this.image.y=e}undoDrag(){return this.image.x=this.selectArea.x,this.image.y=this.selectArea.y}setSelectArea(t,e){return this.selectArea.width=t,this.selectArea.height=e}setMaxSelectArea(){return this.setSelectArea(this.image.width,this.image.height)}getX(){return this.selectArea.x}getY(){return this.selectArea.y}suitAsString(){switch(this.suit){case t.SPADES:return"spades";case t.HEARTS:return"hearts";case t.CLUBS:return"clubs";case t.DIAMONDS:return"diamonds";default:return""}}contains(t){return this.selectArea.contains(t.x,t.y)}setFaceUp(t=!0){var e;if(this.setMaxSelectArea(),this.faceUp=!0,e=this.getImageKey(),this.image.frameName!==e&&(this.image.frameName=e),t)return this.enableInput()}setFaceDown(t=!0){if(this.faceUp=!1,"back"!==this.image.frameName&&(this.image.frameName="back"),t)return this.disableInput()}hide(){return this.disableInput(),this.image.visible=!1}show(){return this.enableInput(),this.image.visible=!0}initializeInput(){return this.image.inputEnabled=!0}initializeDragging(t,e){return this.image.input.enableDrag(!1,!1,!1,255,e),this.image.events.onDragStart.add(t.onDragStart,t),this.image.events.onDragStop.add(t.onDragStop,t)}disableInput(){return this.image.input.enabled=!1,this.image.input.draggable=!1}enableInput(){return this.image.input.enabled=!0,this.image.input.draggable=!0}isClickable(){return this.image.input.enabled}isCovered(){return this.selectArea.width!==this.image.width||this.selectArea.height!==this.image.height}getImageKey(){return`${this.suit}-${this.rank}`}static shuffle(t){var e,i,a;for(e=(a=t.slice(0)).length;--e;)i=Math.floor(Math.random()*(e+1)),[a[e],a[i]]=[a[i],a[e]];return a}static createStandardDeck(e,i,a,s=!1){var r,n,h,o,l;for(r=[],o=n=1;n<=13;o=++n)for(l=h=1;h<=4;l=++h)r.push(new t(e,i,o,l,s));return null!=a&&this.changeCardScale(r,a),r}static changeCardScale(t,e){var i,a,s,r;for(r=[],a=0,s=t.length;a<s;a++)i=t[a],r.push(i.image.scale.set(e));return r}static getCardForImage(t,e){var i,a,s;for(a=0,s=t.length;a<s;a++)if((i=t[a]).image===e)return i}constructor(t,e,i,a,s=!1){this.rank=i,this.suit=a,this.selectArea=new Phaser.Rectangle,s?(this.image=t.add.image(-1e3,-1e3,e,this.getImageKey()),this.setFaceUp(!1)):(this.image=t.add.image(-1e3,-1e3,e,"back"),this.setFaceDown(!1))}}return t.SPADES=1,t.HEARTS=2,t.CLUBS=3,t.DIAMONDS=4,t.ACE=1,t.JACK=11,t.QUEEN=12,t.KING=13,t.ORIG_WIDTH=71,t}.call(this)},503:function(t){t.exports=function(){class t{constructor(t){this.init=this.init.bind(this),this.create=this.create.bind(this),this.assets_dir=t}init(){var e;return 36,e=650,this.game.plugins.add(Phaser.Plugin.SaveCPU).renderOnFPS=60,this.scaleFactor=this.game.width/e,this.menubarHeight=Math.round(36*this.scaleFactor),this.menuSpacing=Math.round(10*this.scaleFactor),document.getElementById("game").style.cursor="default",this.menuFontColor="#FFFFFF",this.menuFont={font:"18pt "+t.MAIN_FONT,fill:this.menuFontColor,align:"center"},this.isWinner=!1,this.winAnimationComplete=!1,this.gameUnderway=!1}create(){var t;return this.backgroundGroup=this.game.add.group(),this.background=this.game.add.image(0,this.menubarHeight,"background"),this.backgroundGroup.add(this.background),this.marker=this.game.add.graphics(0,0),this.playingArea=new Phaser.Rectangle(0,this.menubarHeight,Math.floor(this.PLAY_AREA_RATIO*this.game.width),this.game.height-this.menubarHeight),this.background.scale.set(this.getBackgroundScale(this.background)),null!=this.revealer&&this.initRevealer(),this.drawMenubar(),null!=(t=this.revealer)&&t.create("textures"),this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.fullScreenTarget=document.getElementById("game"),this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.game.scale.refresh()}drawMenubar(){var t,e,i,a,s,r;for((t=this.game.add.bitmapData(this.game.world.width,this.menubarHeight)).addToWorld(),i=a=0,s=this.menubarHeight;0<=s?a<s:a>s;i=0<=s?++a:--a)e=Phaser.Color.interpolateColor(4473924,0,this.menubarHeight,i),t.rect(0,i,this.game.world.width,i+1,Phaser.Color.getWebRGB(e));return this.menubarMidY=this.menubarHeight/2,this.titleText=this.addText(this.game.world.centerX,this.menubarMidY,this.TEXT.title,this.menuFont),this.titleText.anchor.set(.5),this.newGameButton=this.createTextMenuButton(this.menuSpacing,0,"New Game",this.newGame),r=this.game.width-this.menuSpacing,this.fullScreenButton=this.createImageMenuButton(r,1,this.createFullscreenIcon(),this.fullScreen),this.fullScreenButton.scale.set(this.scaleFactor),this.game.scale.onFullScreenError.add(this.fullScreenFailure,this)}createTextMenuButton(t,e,i,a){var s;return(s=this.addText(t,this.menubarMidY,i,this.menuFont)).anchor.set(e,.5),this.configureButton(s,a),s}createImageMenuButton(t,e,i,a){var s;return(s=this.game.add.image(t,this.menubarMidY,i)).anchor.set(e,.5),this.configureButton(s,a),s}configureButton(t,e){return t.inputEnabled=!0,t.input.useHandCursor=!0,t.events.onInputOver.add(this.buttonHoverStart,this),t.events.onInputOut.add(this.buttonHoverStop,this),t.events.onInputDown.add(e,this)}createFullscreenIcon(){var t,e,i;return(e=this.game.add.graphics(0,0)).lineStyle(3,16777215,1),6,t=16,e.lineTo(6,0),e.moveTo(10,0),e.lineTo(t,0),e.lineTo(t,6),e.moveTo(t,10),e.lineTo(t,t),e.lineTo(10,t),e.moveTo(6,t),e.lineTo(0,t),e.lineTo(0,10),e.moveTo(0,6),e.lineTo(0,0),i=e.generateTexture(),e.destroy(),i}getBackgroundScale(t){var e,i,a,s;return a=t.width,e=t.height,s=i=1,a<this.game.width&&(s=this.game.width/t.width),e<this.game.height&&(i=this.game.height/t.height),Math.max(s,i,1)}getGameDimensions(){var t,e,i,a,s;for(e=document.getElementById("game");0===e.clientWidth;)e=e.parentNode;return(s=e.clientWidth)!==document.body.clientWidth?[s,Math.round(this.HEIGHT_WIDTH_RATIO*s)]:((a=document.body.clientHeight)/s>=this.HEIGHT_WIDTH_RATIO?(i=s,t=Math.round(this.HEIGHT_WIDTH_RATIO*i)):(t=a,i=Math.round(1/this.HEIGHT_WIDTH_RATIO*t)),[i,t])}start(){var t,e,i;return[i,t]=this.getGameDimensions(),e={init:this.init,preload:this.preload,create:this.create,update:this.update},this.game=new Phaser.Game(i,t,Phaser.CANVAS,"game",e)}initRevealer(){var t;return(t=this.playingArea.clone()).x=this.playingArea.width+1,t.width=this.game.width-this.playingArea.width,this.revealer.setBounds(t)}addText(t,e,i,a){return(i=this.game.add.text(t,e,i,a)).scale.set(this.scaleFactor),i}buttonHoverStart(t){return null==t.fill_bak&&(t.fill_bak=t.fill),t.fill="#FFFF00"}buttonHoverStop(t){if(null!=t.fill_bak)return t.fill=t.fill_bak}fullScreenFailure(){return alert("Full screen mode didn't work. The device may not support it.")}fullScreen(){return this.game.scale.isFullScreen?this.game.scale.stopFullScreen():this.game.scale.startFullScreen()}newGame(){var t,e;if(this.gameUnderway=!1,this.winAnimationComplete=!1,null!=(t=this.revealer)&&t.resetCovers(),this.isWinner)return this.isWinner=!1,null!=(e=this.revealer)?e.readyImage():void 0}newRevealerImage(){0}toggleAllInputs(t){this.newGameButton.input.enabled=t,this.fullScreenButton.input.enabled=t}}return t.MAIN_FONT="Sarabun",t}.call(this)},394:function(t,e,i){var a,s,r,n=function(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")};s=i(965),r=i(503),a=i(30),t.exports=function(){var t;class e extends r{constructor(){super(...arguments),this.init=this.init.bind(this),this.preload=this.preload.bind(this),this.create=this.create.bind(this),this.update=this.update.bind(this)}init(){return n(this,e),super.init(),this.eventHandler=new s(this),this.TOP_MARGIN=20+this.menubarHeight,this.foundationText=new Array(4),this.topFoundationCard=[-1,-1,-1,-1],this.tableau=function(){var t,e;for(e=[],t=1;t<=7;++t)e.push(new Array(19));return e}(),this.drawPile=new Array,this.wastePile=new Array,this.cardsToDraw=3,this.drawpileFont={font:"14pt "+this.MAIN_FONT,fill:"#FFFFFF"},this.winMsgMajorFont={font:"32pt "+this.MAIN_FONT,fill:"#EFEFDE"},this.winMsgMinorFont={font:"20pt "+this.MAIN_FONT,fill:"#EFEFDE"}}preload(){return n(this,e),this.game.load.atlas("textures",this.assets_dir+"sprites.png",this.assets_dir+"sprites.json"),this.game.load.image("background",this.assets_dir+"background.jpg")}create(){var t,i,a,s,r,h,o;return n(this,e),super.create(),this.game.input.onTap.add(this.onTap,this),t=this.game.width-this.fullScreenButton.width-3*this.menuSpacing,this.flipButton=this.createTextMenuButton(t,1,this.TEXT.flip3,this.changeDrawNumber),this.drawPileCardBack=this.game.add.image(this.PADDING,this.TOP_MARGIN,"textures","back"),this.cardScale=this.getCardScale(),this.drawPileCardBack.scale.set(this.cardScale),this.cardWidth=o=this.drawPileCardBack.width,this.cardHeight=i=this.drawPileCardBack.height,this.SPREAD=Math.round(.2*i),this.COL=function(){var t,e;for(e=[],a=t=0;t<=6;a=++t)e.push(a*(o+this.ELB_ROOM)+this.PADDING);return e}.call(this),h=this.TOP_MARGIN+i+this.LEAD,this.ROW=function(){var t,e;for(e=[],a=t=0;t<=18;a=++t)e.push(h+a*this.SPREAD);return e}.call(this),r=Phaser.Rectangle,this.GOAL=function(){var t,e;for(e=[],a=t=0;t<=3;a=++t)e.push(new r(this.COL[a+3],this.TOP_MARGIN,o,i));return e}.call(this),this.drawPileRect=new r(this.COL[0],this.TOP_MARGIN,o,i),s=i/4,4,this.numBox=new r(this.COL[0],this.TOP_MARGIN+i-s+4,o,s-8),this.initDeck(),this.drawBackgroundBoxes(this.marker),this.deal(),this.drawDrawpile()}update(){var t,i,a,s,r,h;if(n(this,e),this.EXTRA_DRAGGABLES.length>0){for(s=this.SPREAD,h=[],i=0,a=(r=this.EXTRA_DRAGGABLES).length;i<a;i++)(t=r[i]).image.x=this.CURRENTLY_DRAGGED.x,t.image.y=this.CURRENTLY_DRAGGED.y+s,h.push(s+=this.SPREAD);return h}}getCardScale(){return(this.playingArea.width-2*this.PADDING-6*this.ELB_ROOM)/7/a.ORIG_WIDTH}getDrawIconScale(t){return this.cardWidth*this.DRAW_ICON_WIDTH_RATIO/t}drawBackgroundBoxes(t,e=!1){var i,a,s,r,n;for(t.lineStyle(1,this.RECTANGLE_COLOR,1),t.drawRoundedRect(this.COL[0],this.TOP_MARGIN,this.cardWidth,this.cardHeight,4),t.drawRoundedRect(this.COL[1],this.TOP_MARGIN,this.cardWidth,this.cardHeight,4),s=[],i=a=0;a<=3;i=++a)t.drawRoundedRect(this.COL[i+3],this.TOP_MARGIN,this.cardWidth,this.cardHeight,4),r=this.COL[i+3]+this.cardWidth/2,n=this.TOP_MARGIN+this.cardHeight/2,e?(this.foundationText[i].x=r,this.foundationText[i].y=n,this.backgroundGroup.bringToTop(this.foundationText[i])):(this.foundationText[i]=this.game.add.text(r,n,"A",this.FOUNDATION_TEXT_FONT),this.foundationText[i].anchor.set(.5),this.backgroundGroup.add(this.foundationText[i])),s.push(this.foundationText[i].scale.set(this.cardScale));return s}drawDrawpile(){return this.drawIcon=this.game.add.image(this.drawPileRect.centerX,this.drawPileRect.centerY,"textures","flip-arrow"),this.drawIcon.scale.set(this.getDrawIconScale(this.drawIcon.width)),this.drawIcon.anchor.set(.5),this.drawPileText=this.addText(this.numBox.centerX,this.numBox.centerY,`${this.drawPile.length}`,this.drawpileFont),this.drawPileText.anchor.set(.5),this.drawPileText.setShadow(3,3,"#000",5)}initDeck(){var t,e,i,s,r,n;for(this.deck=a.createStandardDeck(this.game,"textures",this.cardScale),e=new Phaser.Rectangle(0,this.menubarHeight,this.game.width,this.playingArea.height),n=[],i=0,s=(r=this.deck).length;i<s;i++)(t=r[i]).initializeInput(),n.push(t.initializeDragging(this.eventHandler,e));return n}newGame(){var t,e,i,a;for(e=0,i=(a=this.deck).length;e<i;e++)(t=a[e]).show(),t.disableInput();return this.deal(),this.drawPileText.text=`${this.drawPile.length}`,this.drawPileText.visible=!0,this.drawPileCardBack.visible=!0,"flip-arrow"!==this.drawIcon.frameName&&(this.drawIcon.frameName="flip-arrow"),this.drawIcon.visible=!0,null!=this.winText1&&(this.winText1.visible=!1,this.winText2.visible=!1),super.newGame()}changeDrawNumber(t){var e,i,a;return e=this.TEXT.flip1,i=this.TEXT.flip3,a=t.text===e?3:1,this.gameUnderway?confirm("Changing this option will start a new game")?(this.cardsToDraw=a,t.text=t.text===e?i:e,this.newGame()):void 0:(this.cardsToDraw=a,t.text=t.text===e?i:e)}deal(){var t,e,i,s,r,n,h,o,l,d,u,c,g,p;for(e=r=0;r<=3;e=++r)this.topFoundationCard[e]=-1;for(;this.drawPile.length>0;)this.drawPile.pop();for(;this.wastePile.length>0;)this.wastePile.pop();for(p=a.shuffle(function(){for(var t=[],e=0;e<=51;e++)t.push(e);return t}.apply(this)),l=0,e=n=0;n<=6;e=++n)for(s=o=0,u=e;0<=u?o<=u:o>=u;s=0<=u?++o:--o)i=p[l],this.tableau[e][s]=i,(t=this.deck[i]).setLocation(this.COL[e],this.ROW[s]),t.image.bringToTop(),s===e?(this.tableau[e][s+1]=-1,t.setFaceUp(!1)):t.setFaceDown(),l++;for(;l<p.length;)i=p[l],this.drawPile.push(i),(t=this.deck[i]).hide(),t.setLocation(this.COL[0],this.TOP_MARGIN),t.setFaceUp(!1),l++;for(g=[],d=0,h=(c=this.deck).length;d<h;d++)(t=c[d]).faceUp?g.push(t.enableInput()):g.push(void 0);return g}checkEmptyDrawAndWastePile(){if(0===this.drawPile.length&&0===this.wastePile.length&&this.drawIcon.visible)return this.drawIcon.visible=!1,this.drawPileText.visible=!1}moveToTableau(t,e,i){var a,s,r,n,h;if(this.isOnWastepile(t))this.tableau[e][i]=this.wastePile.pop(),this.tableau[e][i+1]=-1,t.setLocation(this.COL[e],this.ROW[i]),this.checkEmptyDrawAndWastePile();else{for([a,s]=this.getTableauIndex(t),n=s-1;-1!==this.tableau[a][s];)r=this.tableau[e][i]=this.tableau[a][s],this.tableau[a][s]=-1,this.deck[r].setLocation(this.COL[e],this.ROW[i]),i++,s++;this.tableau[e][i]=-1,n>=0&&(h=this.tableau[a][n],this.deck[h].setFaceUp())}return this.autoProgress()}moveToGoal(t,e,i){var s,r,n,h,o,l;return this.isOnWastepile(t)?(s=this.wastePile.pop(),this.checkEmptyDrawAndWastePile()):([o,l]=this.getTableauIndex(t),s=this.tableau[o][l],h=l-1,this.tableau[o][l]=-1),n=this.deck[this.topFoundationCard[e]],this.topFoundationCard[e]=s,t.disableInput(),this.gameUnderway=!0,r=function(){var i,s;return null!=h&&h>=0&&(s=this.tableau[o][h],this.deck[s].setFaceUp()),t.setLocation(this.GOAL[e].x,this.GOAL[e].y),null!=n&&n.hide(),t.rank===a.KING&&this.checkForWin(),this.isWinner||this.autoProgress(),null!=(i=this.revealer)&&i.reveal(t.suitAsString()),!0},i?(t.image.bringToTop(),this.game.add.tween(t.image).to({x:this.GOAL[e].x,y:this.GOAL[e].y},100,Phaser.Easing.Exponential.InOut,!0).onComplete.addOnce(r,this)):r.call(this)}moveToGoalIfValid(t,e,i,s){var r,n,h,o,l,d,u;for(o=0,l=(r=null!=e?[e]:[0,1,2,3]).length;o<l;o++)if(n=r[o],-1===(h=this.topFoundationCard[n])?u=t.rank===a.ACE:(d=this.deck[h],u=t.suit===d.suit&&d.isOneLowerThan(t)),u&&(!i||this.isAutoSafe(t)))return this.moveToGoal(t,n,s),!0;return!1}isAutoSafe(t){var e,i,a;if(t.rank>2)for(e=t.rank-2,i=a=0;a<=3;i=++a){if(this.topFoundationCard[i]<0)return!1;if(this.deck[this.topFoundationCard[i]].rank<e)return!1}return!0}drawOrFlipWastepile(){var t,e,i;if(this.gameUnderway=!0,0===this.drawPile.length&&3===this.cardsToDraw){if(this.wastePile.length>0){for(;this.wastePile.length>0;)t=this.wastePile.pop(),this.drawPile.push(t),this.deck[t].setLocation(this.COL[0],this.TOP_MARGIN),this.deck[t].hide();this.drawPileCardBack.visible=!0,this.drawIcon.frameName="flip-arrow"}}else{for(e=0,i=this.cardsToDraw;0<=i?e<i:e>i;0<=i?++e:--e)this.drawPile.length>0&&(t=this.drawPile.pop(),this.wastePile.push(t),this.deck[t].setLocation(this.COL[1],this.TOP_MARGIN),this.deck[t].image.bringToTop(),this.deck[t].show());0===this.drawPile.length&&(this.drawPileCardBack.visible=!1,3===this.cardsToDraw?this.drawIcon.frameName="return-arrow":this.drawIcon.frameName="red-x")}return this.drawPileText.text=`${this.drawPile.length}`}onTap(t,e){var i,s;return this.drawPileRect.contains(t.x,t.y)?this.drawOrFlipWastepile():e&&null!=(null!=(s=t.targetObject)?s.sprite:void 0)&&null!=(i=a.getCardForImage(this.deck,t.targetObject.sprite))&&i.isClickable()&&!i.isCovered()?this.moveToGoalIfValid(i,null,!1,!0):void 0}checkForWin(){var t,e,i,s;for(t=e=0;e<=3;t=++e)if((null!=(i=this.deck[this.topFoundationCard[t]])?i.rank:void 0)!==a.KING)return void(null!=(s=this.deck[this.topFoundationCard[t]])?s.rank:void 0);return this.setWinState(),this.animateWin()}autoProgress(){var t,e,i,a,s,r,n,h,o,l,d;if(null==this.disabledCards)for(this.disabledCards=[],s=0,n=(l=this.deck).length;s<n;s++)(t=l[s]).isClickable()&&(t.disableInput(),this.disabledCards.push(t));for(e=!1,i=r=0;r<=6;i=++r)if(-1!==this.tableau[i][0]){for(a=0;a<18&&-1!==this.tableau[i][a+1];)a++;if(t=this.deck[this.tableau[i][a]],e=this.moveToGoalIfValid(t,null,!0,!0))break}if(!e){for(o=0,h=(d=this.disabledCards).length;o<h;o++)(t=d[o]).enableInput();return delete this.disabledCards}}setWinState(){var t,e,i,a,s,r,n,h;for(this.isWinner=!0,e=0,a=(r=this.deck).length;e<a;e++)(t=r[e]).image.bringToTop();for(h=[],i=0,s=(n=this.deck).length;i<s;i++)(t=n[i]).show(),h.push(t.disableInput());return h}toggleAllInputs(t){return this.flipButton.input.enabled=t,super.toggleAllInputs(t)}animateWin(){var t,e,i,a,s;for(this.toggleAllInputs(!1),[t,e]=this.getWinAnimationCardCoords(),i=0,a=[];i<52;)s=this.game.add.tween(this.deck[i].image).to({x:t[i],y:e[i]},1e3,Phaser.Easing.Exponential.InOut,!0,15*i),51===i&&s.onComplete.addOnce(this.displayWinText,this),a.push(i++);return a}displayWinText(){var t,e,i,a,s,r,n,h,o;for(null==this.winText1&&(n=this.playingArea.width/2,a=this.playingArea.height/2,h=(this.menubarHeight+a+this.TOP_MARGIN)/2,o=this.menubarHeight+a+a/2,this.winText1=this.addText(n,h,"Congratulations!",this.winMsgMajorFont),this.winText1.anchor.set(.5),this.winText1.setShadow(3,3,"#000",5),"Click New Game to play again",this.winText2=this.addText(n,o,"Click New Game to play again",this.winMsgMinorFont),this.winText2.anchor.set(.5),this.winText2.setShadow(3,3,"#000",5)),t=0,e=(s=[this.winText1,this.winText2]).length;t<e;t++)i={x:(r=s[t]).scale.x,y:r.scale.y},r.scale.set(.01),r.visible=!0,this.game.add.tween(r.scale).to(i,500,Phaser.Easing.Exponential.Out,!0);return this.winAnimationComplete=!0,this.toggleAllInputs(!0)}getWinAnimationCardCoords(){var t,e,i,a,s,r,n,h,o,l,d;if(null==this.winAnimationCoords){for(t=new Array(13),e=new Array(13),o=0,h=this.cardHeight/2,i=a=0;a<=12;i=++a)o+=Math.PI/26,t[i]=Math.round(h*Math.sin(o)),e[i]=Math.round(h*Math.cos(o));for(l=new Array(52),d=new Array(52),r=(this.playingArea.width-this.cardWidth)/2,n=this.menubarHeight+(this.playingArea.height-this.cardHeight)/2,i=s=0;s<=51;i=++s)i<13?(l[i]=r+t[i],d[i]=n-e[i]):13<=i&&i<26?(l[i]=r+t[25-i],d[i]=n+e[25-i]):26<=i&&i<39?(l[i]=r-t[i-26],d[i]=n+e[i-26]):i>=39&&(l[i]=r-t[51-i],d[i]=n-e[51-i]);this.winAnimationCoords=[l,d]}return this.winAnimationCoords}isOnWastepile(t){return t.getX()===this.COL[1]&&t.getY()===this.TOP_MARGIN}getTableauIndex(t){var e;return e=this.TOP_MARGIN+t.image.height+this.LEAD,[Math.round((t.getX()-this.PADDING)/(t.image.width+this.ELB_ROOM)),Math.round((t.getY()-e)/this.SPREAD)]}}return t=r.MAIN_FONT,e.prototype.TEXT={title:"Solitaire",flip1:"Flip: 1 Card",flip3:"Flip: 3 Cards"},e.prototype.HEIGHT_WIDTH_RATIO=1.3,e.prototype.PLAY_AREA_RATIO=1,e.prototype.ELB_ROOM=5,e.prototype.LEAD=20,e.prototype.PADDING=9,e.prototype.DRAW_ICON_WIDTH_RATIO=.9,e.prototype.EXTRA_DRAGGABLES=[],e.prototype.RECTANGLE_COLOR=1070352,e.prototype.FOUNDATION_TEXT_FONT={font:"48pt "+t,fill:"#104410"},e}.call(this)},965:(t,e,i)=>{var a;a=i(30),t.exports=class{constructor(t){this.main=t}onDragStart(t,e){var i,s,r,n;if(this.clickedCard=a.getCardForImage(this.main.deck,t),this.main.CURRENTLY_DRAGGED=t,t.bringToTop(),!this.main.isOnWastepile(this.clickedCard)){for([s,r]=this.main.getTableauIndex(this.clickedCard),r++,n=[];-1!==this.main.tableau[s][r];)i=this.main.deck[this.main.tableau[s][r]],this.main.EXTRA_DRAGGABLES.push(i),i.image.bringToTop(),n.push(r++);return n}}onDragStop(t,e){var i,s,r,n,h,o,l,d,u,c,g,p;if(p=!1,(d=new Phaser.Point(t.x+Math.floor(t.width/2),t.y+Math.floor(t.height/2))).y>=this.main.ROW[0]){if((null!=this.main.revealer||this.clickedCard.rank===a.KING)&&d.y<=this.main.ROW[0]+t.height)for(s=n=0;n<=6;s=++n)if(-1===this.main.tableau[s][0]&&this.main.COL[s]<=(c=d.x)&&c<=this.main.COL[s]+t.width){this.main.moveToTableau(this.clickedCard,s,0),this.main.gameUnderway=!0,p=!0;break}if(!p)for(s=h=0;h<=6;s=++h)if(-1!==this.main.tableau[s][0]){for(r=0;r<18&&-1!==this.main.tableau[s][r+1];)r++;if((i=this.main.deck[this.main.tableau[s][r]]).contains(d)&&this.clickedCard.isDiffColorThan(i)&&this.clickedCard.isOneLowerThan(i)){i.setSelectArea(t.width,this.main.SPREAD),this.main.moveToTableau(this.clickedCard,s,r+1),this.main.gameUnderway=!0,p=!0;break}}}else if(!this.clickedCard.isCovered())for(s=l=0;l<=3;s=++l)if(this.main.GOAL[s].contains(d.x,d.y)){p=this.main.moveToGoalIfValid(this.clickedCard,s,!1,!1);break}if(!p)for(this.clickedCard.undoDrag(),u=0,o=(g=this.main.EXTRA_DRAGGABLES).length;u<o;u++)(i=g[u]).undoDrag();return this.main.CURRENTLY_DRAGGED=null,this.main.EXTRA_DRAGGABLES=[]}}},419:()=>{Phaser.Plugin.SaveCPU=function(t,e){"use strict";Phaser.Plugin.call(this,t,e)},Phaser.Plugin.SaveCPU.prototype=Object.create(Phaser.Plugin.prototype),Phaser.Plugin.SaveCPU.constructor=Phaser.Plugin.SaveCPU,Phaser.Plugin.SaveCPU.prototype.init=function(){"use strict";var t;this.__defineSetter__("renderOnFPS",(function(t){this._renderOnFPS=t,this._tsdiff=1e3/t})),this.__defineGetter__("renderOnFPS",(function(){return this._renderOnFPS})),this._tsdiff=0,this.renderOnFPS=30,this.renderOnPointerChange=!1,this.renderDirty=!0,this.game.updateRender?this._init1():this._init0(),this.fpsDirty=0,this.hrts=0,t=this,window.requestAnimationFrame((function(e){t._trackFPS(e)}))},Phaser.Plugin.SaveCPU.prototype._init0=function(){this.renderType=this.game.renderType,this.switchRender=this._switchRender0},Phaser.Plugin.SaveCPU.prototype._init1=function(){var t=this.game;t.updateRenderReal=t.updateRender,t.updateRenderNull=function(){},this.switchRender=this._switchRender1},Phaser.Plugin.SaveCPU.prototype._trackFPS=function(t){var e;t-this.hrts>this._tsdiff&&(this.fpsDirty=!0,this.hrts=t),e=this,window.requestAnimationFrame((function(t){e._trackFPS(t)}))},Phaser.Plugin.SaveCPU.prototype._switchRender0=function(){"use strict";var t=this.game;this.renderDirty?t.renderType=this.renderType:t.renderType=Phaser.HEADLESS,this.renderDirty=!1},Phaser.Plugin.SaveCPU.prototype._switchRender1=function(){"use strict";var t=this.game;this.renderDirty?t.updateRender=t.updateRenderReal:t.updateRender=t.updateRenderNull},Phaser.Plugin.SaveCPU.prototype.forceRender=function(){"use strict";this.renderDirty=!0},Phaser.Plugin.SaveCPU.prototype._forceRenderOnPointerChange=function(){"use strict";if(!this.renderOnPointerChange)return!1;var t=this.game.input;t.oldx===t.x&&t.oldy===t.y||(this.forceRender(),t.oldx=t.x,t.oldy=t.y),t.oldDown!==t.activePointer.isDown&&(this.forceRender(),t.oldDown=t.activePointer.isDown)},Phaser.Plugin.SaveCPU.prototype._forceRenderOnFPS=function(){"use strict";return!(!this.renderOnFPS||!this.fpsDirty)&&(this.fpsDirty=!1,this.forceRender(),!0)},Phaser.Plugin.SaveCPU.prototype.postUpdate=function(){"use strict";(this.renderDirty||this._forceRenderOnFPS()||this._forceRenderOnPointerChange())&&this.switchRender()},Phaser.Plugin.SaveCPU.prototype.postRender=function(){"use strict";this.renderDirty&&(this.renderDirty=!1,this.switchRender())}}},e={};function i(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,i),r.exports}(()=>{i(419);const t=i(394);document.addEventListener("DOMContentLoaded",(()=>new t("/static/game_assets/solitaire/").start()))})()})();